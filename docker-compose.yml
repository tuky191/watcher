version: '3'

services:
  redis-master:
    image: redis:6.2.7-alpine
    environment:
      - REDIS_PASSWORD=password123
    networks:
      - watcher
    ports:
      - '6379:6379'

  cockroachdb:
    image: cockroachdb/cockroach:latest-v21.2
    networks:
      - watcher
    ports:
      - '26257:26257'
      - '8080:8080'
    command: start-single-node --insecure

  pulsar:
    image: apachepulsar/pulsar:2.6.0
    container_name: pulsar
    ports:
      - 8081:8080
      - 6650:6650
    environment:
      PULSAR_MEM: ' -Xms512m -Xmx512m -XX:MaxDirectMemorySize=1g'
    volumes:
      - pulsardata:/pulsar/data
      - pulsarconf:/pulsar/conf
    command: /bin/bash -c "bin/pulsar standalone"
    networks:
      - watcher
volumes:
  pulsardata:
  pulsarconf:
networks:
  watcher:
    driver: bridge
